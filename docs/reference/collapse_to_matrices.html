<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Collapse a "tidy" data frame to matrices in a data frame (matsindf) — collapse_to_matrices • matsindf</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Collapse a "tidy" data frame to matrices in a data frame (matsindf) — collapse_to_matrices" />
<meta property="og:description" content="A &quot;tidy&quot; data frame contains information that can be collapsed into matrices,
including columns for
matrix names, row names, column names, row types, column types, and values (entries in matrices).
These column names are specified as strings by the matnames, rownames, colnames,
rowtypes, coltypes, and values arguments to collapse_to_matrices, respectively.
A matsindf-style matrix has named rows and columns.
In addition, matsindf-style matrices have &quot;types&quot; for row and column information,
such as &quot;Commodities&quot;, &quot;Industries&quot;, &quot;Products&quot;, or &quot;Machines&quot;.
The row and column types for the matsindf-style matrices are stored as attributes on the matrix
(rowtype and coltype),
which can be accessed with the rowtype and coltype functions
of the matsbyname package.
Row and column types are both respected and propagated by the various _byname functions
of the matsbyname package.
Use the *_byname functions when you do operations on the matsindf-style matrices.
The matsindf-style matrices will be stored
in a column with same name as the incoming values column.
This function is similar to nest, which stores data frames into a cell of a data frame.
With collapse_to_matrices, matrices are created.
This function is similar to summarise in that groups are respected.
(In fact, calls to this function may not work properly unless grouping is provided.
Errors of the form &quot;Error: Duplicate identifiers for rows ...&quot; are usually fixed by
grouping .DF prior to calling this function.)
The usual approach is to group_by the matnames column
and any other columns to be preserved in the output.
Note that execution is halted if any of
rownames, rowtypes, colnames, coltypes, or values is a grouping variable.
rowtypes and coltypes should be the same for all rows of the same matrix;
execution is halted if that is not the case.
spreading the output by matnames may be necessary before calculations are done on the matrices.
See the example." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">matsindf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/matsindf.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/midf_apply_primer.html">A matsindf_apply primer</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/MatthewHeun/matsindf/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Collapse a "tidy" data frame to matrices in a data frame (<code>matsindf</code>)</h1>
    <small class="dont-index">Source: <a href='https://github.com/MatthewHeun/matsindf/blob/master/R/collapse.R'><code>R/collapse.R</code></a></small>
    <div class="hidden name"><code>collapse_to_matrices.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A "tidy" data frame contains information that can be collapsed into matrices,
including columns for
matrix names, row names, column names, row types, column types, and values (entries in matrices).
These column names are specified as strings by the <code>matnames</code>, <code>rownames</code>, <code>colnames</code>,
<code>rowtypes</code>, <code>coltypes</code>, and <code>values</code> arguments to collapse_to_matrices, respectively.
A <span class="pkg">matsindf</span>-style matrix has named rows and columns.
In addition, <span class="pkg">matsindf</span>-style matrices have "types" for row and column information,
such as "Commodities", "Industries", "Products", or "Machines".
The row and column types for the <span class="pkg">matsindf</span>-style matrices are stored as attributes on the matrix
(<code>rowtype</code> and <code>coltype</code>),
which can be accessed with the <code><a href='https://rdrr.io/pkg/matsbyname/man/rowtype.html'>rowtype</a></code> and <code><a href='https://rdrr.io/pkg/matsbyname/man/coltype.html'>coltype</a></code> functions
of the <span class="pkg">matsbyname</span> package.
Row and column types are both respected and propagated by the various <code>_byname</code> functions
of the <span class="pkg">matsbyname</span> package.
Use the <code>*_byname</code> functions when you do operations on the <span class="pkg">matsindf</span>-style matrices.
The <span class="pkg">matsindf</span>-style matrices will be stored
in a column with same name as the incoming <code>values</code> column.
This function is similar to <code><a href='https://tidyr.tidyverse.org/reference/nest.html'>nest</a></code>, which stores data frames into a cell of a data frame.
With <code>collapse_to_matrices</code>, matrices are created.
This function is similar to <code>summarise</code> in that groups are respected.
(In fact, calls to this function may not work properly unless grouping is provided.
Errors of the form "Error: Duplicate identifiers for rows ..." are usually fixed by
grouping <code>.DF</code> prior to calling this function.)
The usual approach is to <code>group_by</code> the <code>matnames</code> column
and any other columns to be preserved in the output.
Note that execution is halted if any of
<code>rownames</code>, <code>rowtypes</code>, <code>colnames</code>, <code>coltypes</code>, or <code>values</code> is a grouping variable.
<code>rowtypes</code> and <code>coltypes</code> should be the same for all rows of the same matrix;
execution is halted if that is not the case.
<code>spread</code>ing the output by <code>matnames</code> may be necessary before calculations are done on the matrices.
See the example.</p>
    </div>

    <pre class="usage"><span class='fu'>collapse_to_matrices</span><span class='op'>(</span>
  <span class='va'>.DF</span>,
  matnames <span class='op'>=</span> <span class='st'>"matnames"</span>,
  matvals <span class='op'>=</span> <span class='st'>"matvals"</span>,
  rownames <span class='op'>=</span> <span class='st'>"rownames"</span>,
  colnames <span class='op'>=</span> <span class='st'>"colnames"</span>,
  rowtypes <span class='op'>=</span> <span class='st'>"rowtypes"</span>,
  coltypes <span class='op'>=</span> <span class='st'>"coltypes"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.DF</th>
      <td><p>the "tidy" data frame</p></td>
    </tr>
    <tr>
      <th>matnames</th>
      <td><p>a string identifying the column in <code>.DF</code> containing matrix names for matrices to be created.
Default is "<code>matnames</code>".</p></td>
    </tr>
    <tr>
      <th>matvals</th>
      <td><p>a string identifying the column in <code>.DF</code> containing values to be inserted into the matrices to be created.
This will also be the name of the column in the output containing matrices formed from the
data in the <code>matvals</code> column.
Default is "<code>matvals</code>".</p></td>
    </tr>
    <tr>
      <th>rownames</th>
      <td><p>a string identifying the column in <code>.DF</code> containing row names for matrices to be created.
Default is "<code>rownames</code>".</p></td>
    </tr>
    <tr>
      <th>colnames</th>
      <td><p>a string identifying the column in <code>.DF</code> containing column names for matrices to be created.
Default is "<code>colnames</code>".</p></td>
    </tr>
    <tr>
      <th>rowtypes</th>
      <td><p>optional string identifying the column in <code>.DF</code> containing the type of values in rows of the matrices to be created.
Default is "<code>rowtypes</code>".</p></td>
    </tr>
    <tr>
      <th>coltypes</th>
      <td><p>optional string identifying the column in <code>.DF</code> containing the type of values in columns of the matrices to be created
Default is "<code>coltypes</code>".</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a data frame with matrices in columns</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Groups are not preserved on output.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://tidyr.tidyverse.org/reference/nest.html'>nest</a></code> and <code><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘dplyr’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:testthat’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    matches</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    filter, lag</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    intersect, setdiff, setequal, union</span></div><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyr.tidyverse.org'>tidyr</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘tidyr’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:testthat’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    matches</span></div><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tibble.tidyverse.org/'>tibble</a></span><span class='op'>)</span>
<span class='va'>ptype</span> <span class='op'>&lt;-</span> <span class='st'>"Products"</span>
<span class='va'>itype</span> <span class='op'>&lt;-</span> <span class='st'>"Industries"</span>
<span class='va'>tidy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Country <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='st'>"GH"</span>,  <span class='st'>"GH"</span>,  <span class='st'>"GH"</span>,  <span class='st'>"GH"</span>,  <span class='st'>"GH"</span>,  <span class='st'>"GH"</span>,  <span class='st'>"GH"</span>,
                                <span class='st'>"US"</span>,  <span class='st'>"US"</span>,  <span class='st'>"US"</span>,  <span class='st'>"US"</span>, <span class='st'>"GH"</span>, <span class='st'>"US"</span><span class='op'>)</span>,
                  Year    <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>  <span class='fl'>1971</span>,  <span class='fl'>1971</span>,  <span class='fl'>1971</span>,  <span class='fl'>1971</span>,  <span class='fl'>1971</span>,  <span class='fl'>1971</span>,  <span class='fl'>1971</span>,
                                <span class='fl'>1980</span>,  <span class='fl'>1980</span>,  <span class='fl'>1980</span>,  <span class='fl'>1980</span>, <span class='fl'>1971</span>, <span class='fl'>1980</span><span class='op'>)</span>,
                  matrix  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>   <span class='st'>"U"</span>,   <span class='st'>"U"</span>,   <span class='st'>"E"</span>,   <span class='st'>"E"</span>,   <span class='st'>"E"</span>,   <span class='st'>"V"</span>,   <span class='st'>"V"</span>,
                                 <span class='st'>"U"</span>,   <span class='st'>"U"</span>,   <span class='st'>"E"</span>,   <span class='st'>"E"</span>, <span class='st'>"eta"</span>, <span class='st'>"eta"</span><span class='op'>)</span>,
                  row     <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='st'>"c 1"</span>, <span class='st'>"c 2"</span>, <span class='st'>"c 1"</span>, <span class='st'>"c 2"</span>, <span class='st'>"c 2"</span>, <span class='st'>"i 1"</span>, <span class='st'>"i 2"</span>,
                               <span class='st'>"c 1"</span>, <span class='st'>"c 1"</span>, <span class='st'>"c 1"</span>, <span class='st'>"c 2"</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span><span class='op'>)</span>,
                  col     <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='st'>"i 1"</span>, <span class='st'>"i 2"</span>, <span class='st'>"i 1"</span>, <span class='st'>"i 2"</span>, <span class='st'>"i 3"</span>, <span class='st'>"c 1"</span>, <span class='st'>"c 2"</span>,
                               <span class='st'>"i 1"</span>, <span class='st'>"i 2"</span>, <span class='st'>"i 1"</span>, <span class='st'>"i 2"</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span><span class='op'>)</span>,
                  rowtypes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='va'>ptype</span>, <span class='va'>ptype</span>, <span class='va'>ptype</span>, <span class='va'>ptype</span>, <span class='va'>ptype</span>, <span class='va'>itype</span>, <span class='va'>itype</span>,
                                <span class='va'>ptype</span>, <span class='va'>ptype</span>, <span class='va'>ptype</span>, <span class='va'>ptype</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span><span class='op'>)</span>,
                  coltypes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='va'>itype</span>, <span class='va'>itype</span>, <span class='va'>itype</span>, <span class='va'>itype</span>, <span class='va'>itype</span>, <span class='va'>ptype</span>, <span class='va'>ptype</span>,
                                <span class='va'>itype</span>, <span class='va'>itype</span>, <span class='va'>itype</span>, <span class='va'>itype</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span><span class='op'>)</span>,
                  vals  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>    <span class='fl'>11</span>  ,  <span class='fl'>22</span>,    <span class='fl'>11</span> ,   <span class='fl'>22</span> ,   <span class='fl'>23</span> ,   <span class='fl'>11</span> ,   <span class='fl'>22</span> ,
                                <span class='fl'>11</span> ,   <span class='fl'>12</span> ,   <span class='fl'>11</span> ,   <span class='fl'>22</span>,   <span class='fl'>0.2</span>, <span class='fl'>0.3</span><span class='op'>)</span>
<span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Country</span>, <span class='va'>Year</span>, <span class='va'>matrix</span><span class='op'>)</span>
<span class='va'>mats</span> <span class='op'>&lt;-</span> <span class='fu'>collapse_to_matrices</span><span class='op'>(</span><span class='va'>tidy</span>, matnames <span class='op'>=</span> <span class='st'>"matrix"</span>, matvals <span class='op'>=</span> <span class='st'>"vals"</span>,
                             rownames <span class='op'>=</span> <span class='st'>"row"</span>, colnames <span class='op'>=</span> <span class='st'>"col"</span>,
                             rowtypes <span class='op'>=</span> <span class='st'>"rowtypes"</span>, coltypes <span class='op'>=</span> <span class='st'>"coltypes"</span><span class='op'>)</span>
<span class='va'>mats</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/spread.html'>spread</a></span><span class='op'>(</span>key <span class='op'>=</span> <span class='va'>matrix</span>, value <span class='op'>=</span> <span class='va'>vals</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   Country Year                   E eta            U            V
#&gt; 1      GH 1971 11, 0, 0, 22, 0, 23 0.2 11, 0, 0, 22 11, 0, 0, 22
#&gt; 2      US 1980        11, 0, 0, 22 0.3       11, 12         NULL</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matthew Heun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


